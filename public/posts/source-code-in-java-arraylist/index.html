<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="前言 ArrayList，相信大家都不陌生了，它的源码网上也是到处都是，但是我还是想看看，也许会有不一样的发现。
初识 ArrayList ArrayList，顺序列表，非线程安全的，基本用法和数组类似，但是可以扩容。默认初始大小为 10， 扩容大小为 1.5 倍。基本上就这么多。本身构造也简单。
思考 ArrayList 为什么会出现 ArrayList 这个类呢，数组不能够满足要求吗？除了可以扩容，他跟数组有什么区别呢？ 扩容为什么是 1.5 倍？ 初始大小为什么是 10？
ArrayList 源码 ArrayList 变量 基于 1.8 的源码，基本上也没太多可说的，主要针对查找、添加、删除、以及扩容方面进行了解。 首先是 ArrayList 的属性。
public class ArrayList&amp;lt;E&amp;gt; extends AbstractList&amp;lt;E&amp;gt; implements List&amp;lt;E&amp;gt;, RandomAccess, Cloneable, java.io.Serializable { private static final long serialVersionUID = 8683452581122892189L; /** * Default initial capacity. */ private static final int DEFAULT_CAPACITY = 10; /** * Shared empty array instance used for empty instances. */ private static final Object[] EMPTY_ELEMENTDATA = {}; /** * Shared empty array instance used for default sized empty instances." />
<meta name="keywords" content=", code, java, source code" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://keltoy.github.io/posts/source-code-in-java-arraylist/" />


    <title>
        
            Source Code in Java -- ArrayList :: Toy&#39;s Blogs  — 4 Lambda
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.c46cbca46fa76c0fcd3da8313ecf4adee5fb3ffb0288c0902d7e90aead220d79.css">






<meta itemprop="name" content="Source Code in Java -- ArrayList">
<meta itemprop="description" content="前言 ArrayList，相信大家都不陌生了，它的源码网上也是到处都是，但是我还是想看看，也许会有不一样的发现。
初识 ArrayList ArrayList，顺序列表，非线程安全的，基本用法和数组类似，但是可以扩容。默认初始大小为 10， 扩容大小为 1.5 倍。基本上就这么多。本身构造也简单。
思考 ArrayList 为什么会出现 ArrayList 这个类呢，数组不能够满足要求吗？除了可以扩容，他跟数组有什么区别呢？ 扩容为什么是 1.5 倍？ 初始大小为什么是 10？
ArrayList 源码 ArrayList 变量 基于 1.8 的源码，基本上也没太多可说的，主要针对查找、添加、删除、以及扩容方面进行了解。 首先是 ArrayList 的属性。
public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable { private static final long serialVersionUID = 8683452581122892189L; /** * Default initial capacity. */ private static final int DEFAULT_CAPACITY = 10; /** * Shared empty array instance used for empty instances. */ private static final Object[] EMPTY_ELEMENTDATA = {}; /** * Shared empty array instance used for default sized empty instances."><meta itemprop="datePublished" content="2016-10-25T23:46:28&#43;00:00" />
<meta itemprop="dateModified" content="2016-10-25T23:46:28&#43;00:00" />
<meta itemprop="wordCount" content="3225"><meta itemprop="image" content="http://keltoy.github.io/background-cover.jpg"/>
<meta itemprop="keywords" content="code,java,source code," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://keltoy.github.io/background-cover.jpg"/>

<meta name="twitter:title" content="Source Code in Java -- ArrayList"/>
<meta name="twitter:description" content="前言 ArrayList，相信大家都不陌生了，它的源码网上也是到处都是，但是我还是想看看，也许会有不一样的发现。
初识 ArrayList ArrayList，顺序列表，非线程安全的，基本用法和数组类似，但是可以扩容。默认初始大小为 10， 扩容大小为 1.5 倍。基本上就这么多。本身构造也简单。
思考 ArrayList 为什么会出现 ArrayList 这个类呢，数组不能够满足要求吗？除了可以扩容，他跟数组有什么区别呢？ 扩容为什么是 1.5 倍？ 初始大小为什么是 10？
ArrayList 源码 ArrayList 变量 基于 1.8 的源码，基本上也没太多可说的，主要针对查找、添加、删除、以及扩容方面进行了解。 首先是 ArrayList 的属性。
public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable { private static final long serialVersionUID = 8683452581122892189L; /** * Default initial capacity. */ private static final int DEFAULT_CAPACITY = 10; /** * Shared empty array instance used for empty instances. */ private static final Object[] EMPTY_ELEMENTDATA = {}; /** * Shared empty array instance used for default sized empty instances."/>




    <meta property="og:title" content="Source Code in Java -- ArrayList" />
<meta property="og:description" content="前言 ArrayList，相信大家都不陌生了，它的源码网上也是到处都是，但是我还是想看看，也许会有不一样的发现。
初识 ArrayList ArrayList，顺序列表，非线程安全的，基本用法和数组类似，但是可以扩容。默认初始大小为 10， 扩容大小为 1.5 倍。基本上就这么多。本身构造也简单。
思考 ArrayList 为什么会出现 ArrayList 这个类呢，数组不能够满足要求吗？除了可以扩容，他跟数组有什么区别呢？ 扩容为什么是 1.5 倍？ 初始大小为什么是 10？
ArrayList 源码 ArrayList 变量 基于 1.8 的源码，基本上也没太多可说的，主要针对查找、添加、删除、以及扩容方面进行了解。 首先是 ArrayList 的属性。
public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable { private static final long serialVersionUID = 8683452581122892189L; /** * Default initial capacity. */ private static final int DEFAULT_CAPACITY = 10; /** * Shared empty array instance used for empty instances. */ private static final Object[] EMPTY_ELEMENTDATA = {}; /** * Shared empty array instance used for default sized empty instances." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://keltoy.github.io/posts/source-code-in-java-arraylist/" /><meta property="og:image" content="http://keltoy.github.io/background-cover.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-10-25T23:46:28&#43;00:00" />
<meta property="article:modified_time" content="2016-10-25T23:46:28&#43;00:00" /><meta property="og:site_name" content="Toy&#39;s Blogs" />







    <meta property="article:published_time" content="2016-10-25 23:46:28 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">READ-EVAL-PRINT-LOOP</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        16 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="http://keltoy.github.io/posts/source-code-in-java-arraylist/">Source Code in Java &ndash; ArrayList</a>
      </h1>

      

      

      

      <div class="post-content">
        <h1 id="前言">前言</h1>
<p>ArrayList，相信大家都不陌生了，它的源码网上也是到处都是，但是我还是想看看，也许会有不一样的发现。</p>
<h1 id="初识-arraylist">初识 ArrayList</h1>
<p>ArrayList，顺序列表，非线程安全的，基本用法和数组类似，但是可以扩容。默认初始大小为 10， 扩容大小为  1.5 倍。基本上就这么多。本身构造也简单。</p>
<h1 id="思考-arraylist">思考 ArrayList</h1>
<p>为什么会出现 ArrayList 这个类呢，数组不能够满足要求吗？除了可以扩容，他跟数组有什么区别呢？
扩容为什么是 1.5 倍？
初始大小为什么是 10？</p>
<h1 id="arraylist-源码">ArrayList 源码</h1>
<h2 id="arraylist-变量">ArrayList 变量</h2>
<p>基于 1.8 的源码，基本上也没太多可说的，主要针对查找、添加、删除、以及扩容方面进行了解。
首先是 ArrayList 的属性。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ArrayList</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> AbstractList<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span>
        <span style="color:#66d9ef">implements</span> List<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;,</span> RandomAccess<span style="color:#f92672">,</span> Cloneable<span style="color:#f92672">,</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">io</span><span style="color:#f92672">.</span><span style="color:#a6e22e">Serializable</span>
<span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> serialVersionUID <span style="color:#f92672">=</span> 8683452581122892189L<span style="color:#f92672">;</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * Default initial capacity.
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> DEFAULT_CAPACITY <span style="color:#f92672">=</span> 10<span style="color:#f92672">;</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * Shared empty array instance used for empty instances.
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Object<span style="color:#f92672">[]</span> EMPTY_ELEMENTDATA <span style="color:#f92672">=</span> <span style="color:#f92672">{};</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * Shared empty array instance used for default sized empty instances. We
</span><span style="color:#75715e">     * distinguish this from EMPTY_ELEMENTDATA to know how much to inflate when
</span><span style="color:#75715e">     * first element is added.
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Object<span style="color:#f92672">[]</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA <span style="color:#f92672">=</span> <span style="color:#f92672">{};</span>

    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * The array buffer into which the elements of the ArrayList are stored.
</span><span style="color:#75715e">     * The capacity of the ArrayList is the length of this array buffer. Any
</span><span style="color:#75715e">     * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA
</span><span style="color:#75715e">     * will be expanded to DEFAULT_CAPACITY when the first element is added.
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">transient</span> Object<span style="color:#f92672">[]</span> elementData<span style="color:#f92672">;</span> <span style="color:#75715e">// non-private to simplify nested class access
</span><span style="color:#75715e"></span>
    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * The size of the ArrayList (the number of elements it contains).
</span><span style="color:#75715e">     *
</span><span style="color:#75715e">     * @serial
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> size<span style="color:#f92672">;</span>
</code></pre></div><p>可以看出，ArrayList 支持随机访问，支持序列化，以及拷贝；serialVersionUID 这个变量就是用来实现序列化的。</p>
<blockquote>
<p>简单来说，Java的序列化机制是通过在运行时判断类的serialVersionUID来验证版本一致性的。在进行反序列化时，JVM会把传来的字节流中的serialVersionUID与本地相应实体（类）的serialVersionUID进行比较，如果相同就认为是一致的，可以进行反序列化，否则就会出现序列化版本不一致的异常(InvalidCastException)。</p>
</blockquote>
<p>DEFAULT_CAPACITY 定义了初始化容器的大小为 10。也没说为什么，可能和经验有关系。
EMPTY_ELEMENTDATA 定义了一个空数据。DEFAULTCAPACITY_EMPTY_ELEMENTDATA 定义了默认容器空数据。
这俩参数通过注释得知，EMPTY_ELEMENTDATA 是保证所有空数据共享；DEFAULTCAPACITY_EMPTY_ELEMENTDATA 是共享默认大小的空实例。这个实例与之前 EMPTY_ELEMENTDATA 的实例区别在在第一次扩容的时候这个实例才会有所更改。我的理解可能会节省不少空间吧？而且放在 Method Area 中的 runtime constant pool 中，也节约了 gc 的时间？ 以上是我的猜测。
elementData 应该是真正放置数据的地方，注意到的是这个变量使用了 <code>transient</code> 也就是数据不会被序列化/反序列化。这么一来，是不能使用序列化对数据进行传输了。然而，根据经验，ArrayList事实上是可以序列化的。个人猜测，可能是重写了序列化实现的方法。
不过我看了看 Serializable 的接口发现里面其实没有申明方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">package</span> java.io<span style="color:#f92672">;</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> * Serializability of a class is enabled by the class implementing the
</span><span style="color:#75715e"> * java.io.Serializable interface. Classes that do not implement this
</span><span style="color:#75715e"> * interface will not have any of their state serialized or
</span><span style="color:#75715e"> * deserialized.  All subtypes of a serializable class are themselves
</span><span style="color:#75715e"> * serializable.  The serialization interface has no methods or fields
</span><span style="color:#75715e"> * and serves only to identify the semantics of being serializable. &lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * To allow subtypes of non-serializable classes to be serialized, the
</span><span style="color:#75715e"> * subtype may assume responsibility for saving and restoring the
</span><span style="color:#75715e"> * state of the supertype&#39;s public, protected, and (if accessible)
</span><span style="color:#75715e"> * package fields.  The subtype may assume this responsibility only if
</span><span style="color:#75715e"> * the class it extends has an accessible no-arg constructor to
</span><span style="color:#75715e"> * initialize the class&#39;s state.  It is an error to declare a class
</span><span style="color:#75715e"> * Serializable if this is not the case.  The error will be detected at
</span><span style="color:#75715e"> * runtime. &lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * During deserialization, the fields of non-serializable classes will
</span><span style="color:#75715e"> * be initialized using the public or protected no-arg constructor of
</span><span style="color:#75715e"> * the class.  A no-arg constructor must be accessible to the subclass
</span><span style="color:#75715e"> * that is serializable.  The fields of serializable subclasses will
</span><span style="color:#75715e"> * be restored from the stream. &lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * When traversing a graph, an object may be encountered that does not
</span><span style="color:#75715e"> * support the Serializable interface. In this case the
</span><span style="color:#75715e"> * NotSerializableException will be thrown and will identify the class
</span><span style="color:#75715e"> * of the non-serializable object. &lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * Classes that require special handling during the serialization and
</span><span style="color:#75715e"> * deserialization process must implement special methods with these exact
</span><span style="color:#75715e"> * signatures:
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;PRE&gt;
</span><span style="color:#75715e"> * private void writeObject(java.io.ObjectOutputStream out)
</span><span style="color:#75715e"> *     throws IOException
</span><span style="color:#75715e"> * private void readObject(java.io.ObjectInputStream in)
</span><span style="color:#75715e"> *     throws IOException, ClassNotFoundException;
</span><span style="color:#75715e"> * private void readObjectNoData()
</span><span style="color:#75715e"> *     throws ObjectStreamException;
</span><span style="color:#75715e"> * &lt;/PRE&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;p&gt;The writeObject method is responsible for writing the state of the
</span><span style="color:#75715e"> * object for its particular class so that the corresponding
</span><span style="color:#75715e"> * readObject method can restore it.  The default mechanism for saving
</span><span style="color:#75715e"> * the Object&#39;s fields can be invoked by calling
</span><span style="color:#75715e"> * out.defaultWriteObject. The method does not need to concern
</span><span style="color:#75715e"> * itself with the state belonging to its superclasses or subclasses.
</span><span style="color:#75715e"> * State is saved by writing the individual fields to the
</span><span style="color:#75715e"> * ObjectOutputStream using the writeObject method or by using the
</span><span style="color:#75715e"> * methods for primitive data types supported by DataOutput.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;p&gt;The readObject method is responsible for reading from the stream and
</span><span style="color:#75715e"> * restoring the classes fields. It may call in.defaultReadObject to invoke
</span><span style="color:#75715e"> * the default mechanism for restoring the object&#39;s non-static and
</span><span style="color:#75715e"> * non-transient fields.  The defaultReadObject method uses information in
</span><span style="color:#75715e"> * the stream to assign the fields of the object saved in the stream with the
</span><span style="color:#75715e"> * correspondingly named fields in the current object.  This handles the case
</span><span style="color:#75715e"> * when the class has evolved to add new fields. The method does not need to
</span><span style="color:#75715e"> * concern itself with the state belonging to its superclasses or subclasses.
</span><span style="color:#75715e"> * State is saved by writing the individual fields to the
</span><span style="color:#75715e"> * ObjectOutputStream using the writeObject method or by using the
</span><span style="color:#75715e"> * methods for primitive data types supported by DataOutput.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;p&gt;The readObjectNoData method is responsible for initializing the state of
</span><span style="color:#75715e"> * the object for its particular class in the event that the serialization
</span><span style="color:#75715e"> * stream does not list the given class as a superclass of the object being
</span><span style="color:#75715e"> * deserialized.  This may occur in cases where the receiving party uses a
</span><span style="color:#75715e"> * different version of the deserialized instance&#39;s class than the sending
</span><span style="color:#75715e"> * party, and the receiver&#39;s version extends classes that are not extended by
</span><span style="color:#75715e"> * the sender&#39;s version.  This may also occur if the serialization stream has
</span><span style="color:#75715e"> * been tampered; hence, readObjectNoData is useful for initializing
</span><span style="color:#75715e"> * deserialized objects properly despite a &#34;hostile&#34; or incomplete source
</span><span style="color:#75715e"> * stream.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;p&gt;Serializable classes that need to designate an alternative object to be
</span><span style="color:#75715e"> * used when writing an object to the stream should implement this
</span><span style="color:#75715e"> * special method with the exact signature:
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;PRE&gt;
</span><span style="color:#75715e"> * ANY-ACCESS-MODIFIER Object writeReplace() throws ObjectStreamException;
</span><span style="color:#75715e"> * &lt;/PRE&gt;&lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * This writeReplace method is invoked by serialization if the method
</span><span style="color:#75715e"> * exists and it would be accessible from a method defined within the
</span><span style="color:#75715e"> * class of the object being serialized. Thus, the method can have private,
</span><span style="color:#75715e"> * protected and package-private access. Subclass access to this method
</span><span style="color:#75715e"> * follows java accessibility rules. &lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * Classes that need to designate a replacement when an instance of it
</span><span style="color:#75715e"> * is read from the stream should implement this special method with the
</span><span style="color:#75715e"> * exact signature.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;PRE&gt;
</span><span style="color:#75715e"> * ANY-ACCESS-MODIFIER Object readResolve() throws ObjectStreamException;
</span><span style="color:#75715e"> * &lt;/PRE&gt;&lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * This readResolve method follows the same invocation rules and
</span><span style="color:#75715e"> * accessibility rules as writeReplace.&lt;p&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * The serialization runtime associates with each serializable class a version
</span><span style="color:#75715e"> * number, called a serialVersionUID, which is used during deserialization to
</span><span style="color:#75715e"> * verify that the sender and receiver of a serialized object have loaded
</span><span style="color:#75715e"> * classes for that object that are compatible with respect to serialization.
</span><span style="color:#75715e"> * If the receiver has loaded a class for the object that has a different
</span><span style="color:#75715e"> * serialVersionUID than that of the corresponding sender&#39;s class, then
</span><span style="color:#75715e"> * deserialization will result in an {@link InvalidClassException}.  A
</span><span style="color:#75715e"> * serializable class can declare its own serialVersionUID explicitly by
</span><span style="color:#75715e"> * declaring a field named &lt;code&gt;&#34;serialVersionUID&#34;&lt;/code&gt; that must be static,
</span><span style="color:#75715e"> * final, and of type &lt;code&gt;long&lt;/code&gt;:
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * &lt;PRE&gt;
</span><span style="color:#75715e"> * ANY-ACCESS-MODIFIER static final long serialVersionUID = 42L;
</span><span style="color:#75715e"> * &lt;/PRE&gt;
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * If a serializable class does not explicitly declare a serialVersionUID, then
</span><span style="color:#75715e"> * the serialization runtime will calculate a default serialVersionUID value
</span><span style="color:#75715e"> * for that class based on various aspects of the class, as described in the
</span><span style="color:#75715e"> * Java(TM) Object Serialization Specification.  However, it is &lt;em&gt;strongly
</span><span style="color:#75715e"> * recommended&lt;/em&gt; that all serializable classes explicitly declare
</span><span style="color:#75715e"> * serialVersionUID values, since the default serialVersionUID computation is
</span><span style="color:#75715e"> * highly sensitive to class details that may vary depending on compiler
</span><span style="color:#75715e"> * implementations, and can thus result in unexpected
</span><span style="color:#75715e"> * &lt;code&gt;InvalidClassException&lt;/code&gt;s during deserialization.  Therefore, to
</span><span style="color:#75715e"> * guarantee a consistent serialVersionUID value across different java compiler
</span><span style="color:#75715e"> * implementations, a serializable class must declare an explicit
</span><span style="color:#75715e"> * serialVersionUID value.  It is also strongly advised that explicit
</span><span style="color:#75715e"> * serialVersionUID declarations use the &lt;code&gt;private&lt;/code&gt; modifier where
</span><span style="color:#75715e"> * possible, since such declarations apply only to the immediately declaring
</span><span style="color:#75715e"> * class--serialVersionUID fields are not useful as inherited members. Array
</span><span style="color:#75715e"> * classes cannot declare an explicit serialVersionUID, so they always have
</span><span style="color:#75715e"> * the default computed value, but the requirement for matching
</span><span style="color:#75715e"> * serialVersionUID values is waived for array classes.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * @author  unascribed
</span><span style="color:#75715e"> * @see java.io.ObjectOutputStream
</span><span style="color:#75715e"> * @see java.io.ObjectInputStream
</span><span style="color:#75715e"> * @see java.io.ObjectOutput
</span><span style="color:#75715e"> * @see java.io.ObjectInput
</span><span style="color:#75715e"> * @see java.io.Externalizable
</span><span style="color:#75715e"> * @since   JDK1.1
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Serializable</span> <span style="color:#f92672">{</span>
<span style="color:#f92672">}</span>

</code></pre></div><p>很长很长的说明。大概看看突然想起来了，实现 <code>Serializable</code> 是需要重写 writeObject 和 readObject 等方法。我猜测是重写了该方法。</p>
<p>size 变量就是数据的大小了。</p>
<h2 id="arraylist-构造方法">ArrayList 构造方法</h2>
<p>继续查看源代码，可以看到 ArrayList 的 constructors：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * Constructs an empty list with the specified initial capacity.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * @param  initialCapacity  the initial capacity of the list
</span><span style="color:#75715e"> * @throws IllegalArgumentException if the specified initial capacity
</span><span style="color:#75715e"> *         is negative
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">ArrayList</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> initialCapacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>initialCapacity <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">elementData</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Object<span style="color:#f92672">[</span>initialCapacity<span style="color:#f92672">];</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>initialCapacity <span style="color:#f92672">==</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">elementData</span> <span style="color:#f92672">=</span> EMPTY_ELEMENTDATA<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Illegal Capacity: &#34;</span><span style="color:#f92672">+</span>
                                           initialCapacity<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> * Constructs an empty list with an initial capacity of ten.
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">ArrayList</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">elementData</span> <span style="color:#f92672">=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> * Constructs a list containing the elements of the specified
</span><span style="color:#75715e"> * collection, in the order they are returned by the collection&#39;s
</span><span style="color:#75715e"> * iterator.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * @param c the collection whose elements are to be placed into this list
</span><span style="color:#75715e"> * @throws NullPointerException if the specified collection is null
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">ArrayList</span><span style="color:#f92672">(</span>Collection<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">extends</span> E<span style="color:#f92672">&gt;</span> c<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    elementData <span style="color:#f92672">=</span> c<span style="color:#f92672">.</span><span style="color:#a6e22e">toArray</span><span style="color:#f92672">();</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">((</span>size <span style="color:#f92672">=</span> elementData<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">)</span> <span style="color:#f92672">!=</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// c.toArray might (incorrectly) not return Object[] (see 6260652)
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>elementData<span style="color:#f92672">.</span><span style="color:#a6e22e">getClass</span><span style="color:#f92672">()</span> <span style="color:#f92672">!=</span> Object<span style="color:#f92672">[].</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
            elementData <span style="color:#f92672">=</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">copyOf</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">,</span> size<span style="color:#f92672">,</span> Object<span style="color:#f92672">[].</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">// replace with empty array.
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">elementData</span> <span style="color:#f92672">=</span> EMPTY_ELEMENTDATA<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

</code></pre></div><p>这里定义了三个 constructor， 我其实挺好奇默认构造方法的实现，和给定参数为 0 构造函数，这俩还不一样。默认的构造方法，是一个空对象数组 DEFAULTCAPACITY_EMPTY_ELEMENTDATA。</p>
<h2 id="arraylist-扩容等方法">ArrayList 扩容等方法</h2>
<p>查看关于容量的源码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * Increases the capacity of this &lt;tt&gt;ArrayList&lt;/tt&gt; instance, if
</span><span style="color:#75715e">     * necessary, to ensure that it can hold at least the number of elements
</span><span style="color:#75715e">     * specified by the minimum capacity argument.
</span><span style="color:#75715e">     *
</span><span style="color:#75715e">     * @param   minCapacity   the desired minimum capacity
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ensureCapacity</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> minCapacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">int</span> minExpand <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>elementData <span style="color:#f92672">!=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span style="color:#f92672">)</span>
            <span style="color:#75715e">// any size if not default element table
</span><span style="color:#75715e"></span>            <span style="color:#f92672">?</span> 0
            <span style="color:#75715e">// larger than default for default empty table. It&#39;s already
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// supposed to be at default size.
</span><span style="color:#75715e"></span>            <span style="color:#f92672">:</span> DEFAULT_CAPACITY<span style="color:#f92672">;</span>

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>minCapacity <span style="color:#f92672">&gt;</span> minExpand<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            ensureExplicitCapacity<span style="color:#f92672">(</span>minCapacity<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>

</code></pre></div><p>ensureCapacity 保证容量，如果不是默认空数据，那么 minExpand 为 0，否则为 DEFAULT_CAPACITY，也就是 10。 如果 minCapacity 大于 minExpand，也就是说需要扩展的大小比默认大小还大，那么就调用 ensureExplicitCapacity，显式扩容。
源码中并没有使用这个方法，而是下面的方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ensureCapacityInternal</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> minCapacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>elementData <span style="color:#f92672">==</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        minCapacity <span style="color:#f92672">=</span> Math<span style="color:#f92672">.</span><span style="color:#a6e22e">max</span><span style="color:#f92672">(</span>DEFAULT_CAPACITY<span style="color:#f92672">,</span> minCapacity<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>

    ensureExplicitCapacity<span style="color:#f92672">(</span>minCapacity<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>ensureCapacityInternal，这个方法在其他的方法中有所调用。跟之前的类似，也是比较默认容器大小和 minCapacity 的大小。不同的地方在于，不论如何这里都会进行 ensureExplicitCapacity，如果调用 ensureCapacity， 那么</p>
<p>$$
minCapacity \le  minExpand
$$</p>
<p>不会进行任何操作。我的理解是，在初始化的时候会省去很多不必要的开销。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ensureExplicitCapacity</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> minCapacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    modCount<span style="color:#f92672">++;</span>

    <span style="color:#75715e">// overflow-conscious code
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>minCapacity <span style="color:#f92672">-</span> elementData<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span>
        grow<span style="color:#f92672">(</span>minCapacity<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>这个方法才是保证扩容的真正方法。
modCount， 这个变量是从 AbstractList<!-- raw HTML omitted --> 继承过来的：</p>
<pre><code>protected transient int modCount = 0;
</code></pre>
<p>猜一下也知道，用来记录扩容次数的。不论是否扩容，都会加一。然后，如果需要的容量比现在的长度还大，就扩容。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * The maximum size of array to allocate.
</span><span style="color:#75715e"> * Some VMs reserve some header words in an array.
</span><span style="color:#75715e"> * Attempts to allocate larger arrays may result in
</span><span style="color:#75715e"> * OutOfMemoryError: Requested array size exceeds VM limit
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> MAX_ARRAY_SIZE <span style="color:#f92672">=</span> Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">MAX_VALUE</span> <span style="color:#f92672">-</span> 8<span style="color:#f92672">;</span>

<span style="color:#75715e">/**
</span><span style="color:#75715e"> * Increases the capacity to ensure that it can hold at least the
</span><span style="color:#75715e"> * number of elements specified by the minimum capacity argument.
</span><span style="color:#75715e"> *
</span><span style="color:#75715e"> * @param minCapacity the desired minimum capacity
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">grow</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> minCapacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// overflow-conscious code
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">int</span> oldCapacity <span style="color:#f92672">=</span> elementData<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">int</span> newCapacity <span style="color:#f92672">=</span> oldCapacity <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>oldCapacity <span style="color:#f92672">&gt;&gt;</span> 1<span style="color:#f92672">);</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>newCapacity <span style="color:#f92672">-</span> minCapacity <span style="color:#f92672">&lt;</span> 0<span style="color:#f92672">)</span>
        newCapacity <span style="color:#f92672">=</span> minCapacity<span style="color:#f92672">;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>newCapacity <span style="color:#f92672">-</span> MAX_ARRAY_SIZE <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span>
        newCapacity <span style="color:#f92672">=</span> hugeCapacity<span style="color:#f92672">(</span>minCapacity<span style="color:#f92672">);</span>
    <span style="color:#75715e">// minCapacity is usually close to size, so this is a win:
</span><span style="color:#75715e"></span>    elementData <span style="color:#f92672">=</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">copyOf</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">,</span> newCapacity<span style="color:#f92672">);</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>这里介绍的很清楚，MAX_ARRAY_SIZE 再大可能对某些虚拟机产生 OutOfMemoryError。为什么要减 8？因为要有 8 个自己去存储这个大小。
$$ 2^{31} = 2,147,483,648 $$
这个还是要存起来的。
grow 方法会对原油的数据大小进行扩容。新的大小是旧的大小的 1.5 倍（取下界）？如果这个大小比需要的大小还小，那么这个大小设置为需要的大小；如果超出了 MAX_ARRAY_SIZE，就更换策略，使用 hugeCapacity 进行扩容。
这里的扩容方式跟之前说的不太一样，我猜测是因为位运算比普通运算要快。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">hugeCapacity</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> minCapacity<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>minCapacity <span style="color:#f92672">&lt;</span> 0<span style="color:#f92672">)</span> <span style="color:#75715e">// overflow
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> OutOfMemoryError<span style="color:#f92672">();</span>
    <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>minCapacity <span style="color:#f92672">&gt;</span> MAX_ARRAY_SIZE<span style="color:#f92672">)</span> <span style="color:#f92672">?</span>
        Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">MAX_VALUE</span> <span style="color:#f92672">:</span>
        MAX_ARRAY_SIZE<span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>注意这里会引发 OutOfMemoryError 错误。这里最大也只能到整型的最大。</p>
<h2 id="arraylist-增删改查">ArrayList 增删改查</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">   * Returns the element at the specified position in this list.
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param  index index of the element to return
</span><span style="color:#75715e">   * @return the element at the specified position in this list
</span><span style="color:#75715e">   * @throws IndexOutOfBoundsException {@inheritDoc}
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> E <span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      rangeCheck<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>

      <span style="color:#66d9ef">return</span> elementData<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Replaces the element at the specified position in this list with
</span><span style="color:#75715e">   * the specified element.
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param index index of the element to replace
</span><span style="color:#75715e">   * @param element element to be stored at the specified position
</span><span style="color:#75715e">   * @return the element previously at the specified position
</span><span style="color:#75715e">   * @throws IndexOutOfBoundsException {@inheritDoc}
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> E <span style="color:#a6e22e">set</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> E element<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      rangeCheck<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>

      E oldValue <span style="color:#f92672">=</span> elementData<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>
      elementData<span style="color:#f92672">[</span>index<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> element<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">return</span> oldValue<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Appends the specified element to the end of this list.
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param e element to be appended to this list
</span><span style="color:#75715e">   * @return &lt;tt&gt;true&lt;/tt&gt; (as specified by {@link Collection#add})
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>E e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      ensureCapacityInternal<span style="color:#f92672">(</span>size <span style="color:#f92672">+</span> 1<span style="color:#f92672">);</span>  <span style="color:#75715e">// Increments modCount!!
</span><span style="color:#75715e"></span>      elementData<span style="color:#f92672">[</span>size<span style="color:#f92672">++]</span> <span style="color:#f92672">=</span> e<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Inserts the specified element at the specified position in this
</span><span style="color:#75715e">   * list. Shifts the element currently at that position (if any) and
</span><span style="color:#75715e">   * any subsequent elements to the right (adds one to their indices).
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param index index at which the specified element is to be inserted
</span><span style="color:#75715e">   * @param element element to be inserted
</span><span style="color:#75715e">   * @throws IndexOutOfBoundsException {@inheritDoc}
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> E element<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      rangeCheckForAdd<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>

      ensureCapacityInternal<span style="color:#f92672">(</span>size <span style="color:#f92672">+</span> 1<span style="color:#f92672">);</span>  <span style="color:#75715e">// Increments modCount!!
</span><span style="color:#75715e"></span>      System<span style="color:#f92672">.</span><span style="color:#a6e22e">arraycopy</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> elementData<span style="color:#f92672">,</span> index <span style="color:#f92672">+</span> 1<span style="color:#f92672">,</span>
                       size <span style="color:#f92672">-</span> index<span style="color:#f92672">);</span>
      elementData<span style="color:#f92672">[</span>index<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> element<span style="color:#f92672">;</span>
      size<span style="color:#f92672">++;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Removes the element at the specified position in this list.
</span><span style="color:#75715e">   * Shifts any subsequent elements to the left (subtracts one from their
</span><span style="color:#75715e">   * indices).
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param index the index of the element to be removed
</span><span style="color:#75715e">   * @return the element that was removed from the list
</span><span style="color:#75715e">   * @throws IndexOutOfBoundsException {@inheritDoc}
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> E <span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      rangeCheck<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>

      modCount<span style="color:#f92672">++;</span>
      E oldValue <span style="color:#f92672">=</span> elementData<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>

      <span style="color:#66d9ef">int</span> numMoved <span style="color:#f92672">=</span> size <span style="color:#f92672">-</span> index <span style="color:#f92672">-</span> 1<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>numMoved <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span>
          System<span style="color:#f92672">.</span><span style="color:#a6e22e">arraycopy</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">,</span> index<span style="color:#f92672">+</span>1<span style="color:#f92672">,</span> elementData<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span>
                           numMoved<span style="color:#f92672">);</span>
      elementData<span style="color:#f92672">[--</span>size<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span> <span style="color:#75715e">// clear to let GC do its work
</span><span style="color:#75715e"></span>
      <span style="color:#66d9ef">return</span> oldValue<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Removes the first occurrence of the specified element from this list,
</span><span style="color:#75715e">   * if it is present.  If the list does not contain the element, it is
</span><span style="color:#75715e">   * unchanged.  More formally, removes the element with the lowest index
</span><span style="color:#75715e">   * &lt;tt&gt;i&lt;/tt&gt; such that
</span><span style="color:#75715e">   * &lt;tt&gt;(o==null&amp;nbsp;?&amp;nbsp;get(i)==null&amp;nbsp;:&amp;nbsp;o.equals(get(i)))&lt;/tt&gt;
</span><span style="color:#75715e">   * (if such an element exists).  Returns &lt;tt&gt;true&lt;/tt&gt; if this list
</span><span style="color:#75715e">   * contained the specified element (or equivalently, if this list
</span><span style="color:#75715e">   * changed as a result of the call).
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param o element to be removed from this list, if present
</span><span style="color:#75715e">   * @return &lt;tt&gt;true&lt;/tt&gt; if this list contained the specified element
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">remove</span><span style="color:#f92672">(</span>Object o<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>o <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> index <span style="color:#f92672">&lt;</span> size<span style="color:#f92672">;</span> index<span style="color:#f92672">++)</span>
              <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>elementData<span style="color:#f92672">[</span>index<span style="color:#f92672">]</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                  fastRemove<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>
                  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> index <span style="color:#f92672">&lt;</span> size<span style="color:#f92672">;</span> index<span style="color:#f92672">++)</span>
              <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>o<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">[</span>index<span style="color:#f92672">]))</span> <span style="color:#f92672">{</span>
                  fastRemove<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>
                  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span>
      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/*
</span><span style="color:#75715e">   * Private remove method that skips bounds checking and does not
</span><span style="color:#75715e">   * return the value removed.
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fastRemove</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      modCount<span style="color:#f92672">++;</span>
      <span style="color:#66d9ef">int</span> numMoved <span style="color:#f92672">=</span> size <span style="color:#f92672">-</span> index <span style="color:#f92672">-</span> 1<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>numMoved <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span>
          System<span style="color:#f92672">.</span><span style="color:#a6e22e">arraycopy</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">,</span> index<span style="color:#f92672">+</span>1<span style="color:#f92672">,</span> elementData<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span>
                           numMoved<span style="color:#f92672">);</span>
      elementData<span style="color:#f92672">[--</span>size<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span> <span style="color:#75715e">// clear to let GC do its work
</span><span style="color:#75715e"></span>  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Removes all of the elements from this list.  The list will
</span><span style="color:#75715e">   * be empty after this call returns.
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">clear</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
      modCount<span style="color:#f92672">++;</span>

      <span style="color:#75715e">// clear to let GC do its work
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> size<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span>
          elementData<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>

      size <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Appends all of the elements in the specified collection to the end of
</span><span style="color:#75715e">   * this list, in the order that they are returned by the
</span><span style="color:#75715e">   * specified collection&#39;s Iterator.  The behavior of this operation is
</span><span style="color:#75715e">   * undefined if the specified collection is modified while the operation
</span><span style="color:#75715e">   * is in progress.  (This implies that the behavior of this call is
</span><span style="color:#75715e">   * undefined if the specified collection is this list, and this
</span><span style="color:#75715e">   * list is nonempty.)
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param c collection containing elements to be added to this list
</span><span style="color:#75715e">   * @return &lt;tt&gt;true&lt;/tt&gt; if this list changed as a result of the call
</span><span style="color:#75715e">   * @throws NullPointerException if the specified collection is null
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span><span style="color:#f92672">(</span>Collection<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">extends</span> E<span style="color:#f92672">&gt;</span> c<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      Object<span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> c<span style="color:#f92672">.</span><span style="color:#a6e22e">toArray</span><span style="color:#f92672">();</span>
      <span style="color:#66d9ef">int</span> numNew <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>
      ensureCapacityInternal<span style="color:#f92672">(</span>size <span style="color:#f92672">+</span> numNew<span style="color:#f92672">);</span>  <span style="color:#75715e">// Increments modCount
</span><span style="color:#75715e"></span>      System<span style="color:#f92672">.</span><span style="color:#a6e22e">arraycopy</span><span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> elementData<span style="color:#f92672">,</span> size<span style="color:#f92672">,</span> numNew<span style="color:#f92672">);</span>
      size <span style="color:#f92672">+=</span> numNew<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">return</span> numNew <span style="color:#f92672">!=</span> 0<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Inserts all of the elements in the specified collection into this
</span><span style="color:#75715e">   * list, starting at the specified position.  Shifts the element
</span><span style="color:#75715e">   * currently at that position (if any) and any subsequent elements to
</span><span style="color:#75715e">   * the right (increases their indices).  The new elements will appear
</span><span style="color:#75715e">   * in the list in the order that they are returned by the
</span><span style="color:#75715e">   * specified collection&#39;s iterator.
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @param index index at which to insert the first element from the
</span><span style="color:#75715e">   *              specified collection
</span><span style="color:#75715e">   * @param c collection containing elements to be added to this list
</span><span style="color:#75715e">   * @return &lt;tt&gt;true&lt;/tt&gt; if this list changed as a result of the call
</span><span style="color:#75715e">   * @throws IndexOutOfBoundsException {@inheritDoc}
</span><span style="color:#75715e">   * @throws NullPointerException if the specified collection is null
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index<span style="color:#f92672">,</span> Collection<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">extends</span> E<span style="color:#f92672">&gt;</span> c<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      rangeCheckForAdd<span style="color:#f92672">(</span>index<span style="color:#f92672">);</span>

      Object<span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> c<span style="color:#f92672">.</span><span style="color:#a6e22e">toArray</span><span style="color:#f92672">();</span>
      <span style="color:#66d9ef">int</span> numNew <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span>
      ensureCapacityInternal<span style="color:#f92672">(</span>size <span style="color:#f92672">+</span> numNew<span style="color:#f92672">);</span>  <span style="color:#75715e">// Increments modCount
</span><span style="color:#75715e"></span>
      <span style="color:#66d9ef">int</span> numMoved <span style="color:#f92672">=</span> size <span style="color:#f92672">-</span> index<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>numMoved <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span>
          System<span style="color:#f92672">.</span><span style="color:#a6e22e">arraycopy</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> elementData<span style="color:#f92672">,</span> index <span style="color:#f92672">+</span> numNew<span style="color:#f92672">,</span>
                           numMoved<span style="color:#f92672">);</span>

      System<span style="color:#f92672">.</span><span style="color:#a6e22e">arraycopy</span><span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> 0<span style="color:#f92672">,</span> elementData<span style="color:#f92672">,</span> index<span style="color:#f92672">,</span> numNew<span style="color:#f92672">);</span>
      size <span style="color:#f92672">+=</span> numNew<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">return</span> numNew <span style="color:#f92672">!=</span> 0<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Removes from this list all of the elements whose index is between
</span><span style="color:#75715e">   * {@code fromIndex}, inclusive, and {@code toIndex}, exclusive.
</span><span style="color:#75715e">   * Shifts any succeeding elements to the left (reduces their index).
</span><span style="color:#75715e">   * This call shortens the list by {@code (toIndex - fromIndex)} elements.
</span><span style="color:#75715e">   * (If {@code toIndex==fromIndex}, this operation has no effect.)
</span><span style="color:#75715e">   *
</span><span style="color:#75715e">   * @throws IndexOutOfBoundsException if {@code fromIndex} or
</span><span style="color:#75715e">   *         {@code toIndex} is out of range
</span><span style="color:#75715e">   *         ({@code fromIndex &lt; 0 ||
</span><span style="color:#75715e">   *          fromIndex &gt;= size() ||
</span><span style="color:#75715e">   *          toIndex &gt; size() ||
</span><span style="color:#75715e">   *          toIndex &lt; fromIndex})
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">removeRange</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> fromIndex<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> toIndex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      modCount<span style="color:#f92672">++;</span>
      <span style="color:#66d9ef">int</span> numMoved <span style="color:#f92672">=</span> size <span style="color:#f92672">-</span> toIndex<span style="color:#f92672">;</span>
      System<span style="color:#f92672">.</span><span style="color:#a6e22e">arraycopy</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">,</span> toIndex<span style="color:#f92672">,</span> elementData<span style="color:#f92672">,</span> fromIndex<span style="color:#f92672">,</span>
                       numMoved<span style="color:#f92672">);</span>

      <span style="color:#75715e">// clear to let GC do its work
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">int</span> newSize <span style="color:#f92672">=</span> size <span style="color:#f92672">-</span> <span style="color:#f92672">(</span>toIndex<span style="color:#f92672">-</span>fromIndex<span style="color:#f92672">);</span>
      <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> newSize<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> size<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
          elementData<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>
      size <span style="color:#f92672">=</span> newSize<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Checks if the given index is in range.  If not, throws an appropriate
</span><span style="color:#75715e">   * runtime exception.  This method does *not* check if the index is
</span><span style="color:#75715e">   * negative: It is always used immediately prior to an array access,
</span><span style="color:#75715e">   * which throws an ArrayIndexOutOfBoundsException if index is negative.
</span><span style="color:#75715e">   */</span>
  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">rangeCheck</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> index<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>index <span style="color:#f92672">&gt;=</span> size<span style="color:#f92672">)</span>
          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IndexOutOfBoundsException<span style="color:#f92672">(</span>outOfBoundsMsg<span style="color:#f92672">(</span>index<span style="color:#f92672">));</span>
  <span style="color:#f92672">}</span>

</code></pre></div><p>以上的代码基本上没有特别难懂的，基本上都是依靠 Arrays 的方法实现的，没有特别说明的。</p>
<h2 id="arraylist-其他方法">ArrayList 其他方法</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/**
</span><span style="color:#75715e">    * Save the state of the &lt;tt&gt;ArrayList&lt;/tt&gt; instance to a stream (that
</span><span style="color:#75715e">    * is, serialize it).
</span><span style="color:#75715e">    *
</span><span style="color:#75715e">    * @serialData The length of the array backing the &lt;tt&gt;ArrayList&lt;/tt&gt;
</span><span style="color:#75715e">    *             instance is emitted (int), followed by all of its elements
</span><span style="color:#75715e">    *             (each an &lt;tt&gt;Object&lt;/tt&gt;) in the proper order.
</span><span style="color:#75715e">    */</span>
   <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writeObject</span><span style="color:#f92672">(</span>java<span style="color:#f92672">.</span><span style="color:#a6e22e">io</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ObjectOutputStream</span> s<span style="color:#f92672">)</span>
       <span style="color:#66d9ef">throws</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">io</span><span style="color:#f92672">.</span><span style="color:#a6e22e">IOException</span><span style="color:#f92672">{</span>
       <span style="color:#75715e">// Write out element count, and any hidden stuff
</span><span style="color:#75715e"></span>       <span style="color:#66d9ef">int</span> expectedModCount <span style="color:#f92672">=</span> modCount<span style="color:#f92672">;</span>
       s<span style="color:#f92672">.</span><span style="color:#a6e22e">defaultWriteObject</span><span style="color:#f92672">();</span>

       <span style="color:#75715e">// Write out size as capacity for behavioural compatibility with clone()
</span><span style="color:#75715e"></span>       s<span style="color:#f92672">.</span><span style="color:#a6e22e">writeInt</span><span style="color:#f92672">(</span>size<span style="color:#f92672">);</span>

       <span style="color:#75715e">// Write out all elements in the proper order.
</span><span style="color:#75715e"></span>       <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span>0<span style="color:#f92672">;</span> i<span style="color:#f92672">&lt;</span>size<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
           s<span style="color:#f92672">.</span><span style="color:#a6e22e">writeObject</span><span style="color:#f92672">(</span>elementData<span style="color:#f92672">[</span>i<span style="color:#f92672">]);</span>
       <span style="color:#f92672">}</span>

       <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>modCount <span style="color:#f92672">!=</span> expectedModCount<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
           <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> ConcurrentModificationException<span style="color:#f92672">();</span>
       <span style="color:#f92672">}</span>
   <span style="color:#f92672">}</span>

   <span style="color:#75715e">/**
</span><span style="color:#75715e">    * Reconstitute the &lt;tt&gt;ArrayList&lt;/tt&gt; instance from a stream (that is,
</span><span style="color:#75715e">    * deserialize it).
</span><span style="color:#75715e">    */</span>
   <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">readObject</span><span style="color:#f92672">(</span>java<span style="color:#f92672">.</span><span style="color:#a6e22e">io</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ObjectInputStream</span> s<span style="color:#f92672">)</span>
       <span style="color:#66d9ef">throws</span> java<span style="color:#f92672">.</span><span style="color:#a6e22e">io</span><span style="color:#f92672">.</span><span style="color:#a6e22e">IOException</span><span style="color:#f92672">,</span> ClassNotFoundException <span style="color:#f92672">{</span>
       elementData <span style="color:#f92672">=</span> EMPTY_ELEMENTDATA<span style="color:#f92672">;</span>

       <span style="color:#75715e">// Read in size, and any hidden stuff
</span><span style="color:#75715e"></span>       s<span style="color:#f92672">.</span><span style="color:#a6e22e">defaultReadObject</span><span style="color:#f92672">();</span>

       <span style="color:#75715e">// Read in capacity
</span><span style="color:#75715e"></span>       s<span style="color:#f92672">.</span><span style="color:#a6e22e">readInt</span><span style="color:#f92672">();</span> <span style="color:#75715e">// ignored
</span><span style="color:#75715e"></span>
       <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>size <span style="color:#f92672">&gt;</span> 0<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
           <span style="color:#75715e">// be like clone(), allocate array based upon size not capacity
</span><span style="color:#75715e"></span>           ensureCapacityInternal<span style="color:#f92672">(</span>size<span style="color:#f92672">);</span>

           Object<span style="color:#f92672">[]</span> a <span style="color:#f92672">=</span> elementData<span style="color:#f92672">;</span>
           <span style="color:#75715e">// Read in all elements in the proper order.
</span><span style="color:#75715e"></span>           <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span>0<span style="color:#f92672">;</span> i<span style="color:#f92672">&lt;</span>size<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
               a<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span><span style="color:#a6e22e">readObject</span><span style="color:#f92672">();</span>
           <span style="color:#f92672">}</span>
       <span style="color:#f92672">}</span>
   <span style="color:#f92672">}</span>
</code></pre></div><p>与之前猜测的一样，这里确实重写了 writeObject 和 readObject，用来实现序列化。</p>
<p>除此之外还有 SubList 和 Iterator 的实现，没有太多需要说明的，因为本身就比较简单。</p>
<h1 id="总结">总结</h1>
<p>ArrayList 在所有集合中应该算是比较简单的，没有同步，没有复杂的分块，也是用的最多的一种集合。需要注意的地方一个是它的最大值，一个是扩容的机制。</p>
<h1 id="参考">参考</h1>
<p><a href="http://www.cnblogs.com/guanghuiqq/archive/2012/07/18/2597036.html">serialVersionUID的作用</a></p>
<p><a href="http://stackoverflow.com/questions/35756277/why-the-maximum-array-size-of-arraylist-is-integer-max-value-8">Why the maximum array size of ArrayList is Integer.MAX_VALUE - 8?</a></p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://keltoy.github.io/tags/code/">code</a></span>
        <span class="tag"><a href="http://keltoy.github.io/tags/java/">java</a></span>
        <span class="tag"><a href="http://keltoy.github.io/tags/source-code/">source code</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        3225 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2016-10-26 07:46 &#43;0800
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Source%20Code%20in%20Java%20--%20ArrayList&amp;caption=Source%20Code%20in%20Java%20--%20ArrayList&amp;canonicalUrl=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Source%20Code%20in%20Java%20--%20ArrayList&amp;body=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f&amp;media=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f;description=Source%20Code%20in%20Java%20--%20ArrayList" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f&amp;title=Source%20Code%20in%20Java%20--%20ArrayList&amp;summary=Source%20Code%20in%20Java%20--%20ArrayList&amp;source=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f&amp;resubmit=true&amp;title=Source%20Code%20in%20Java%20--%20ArrayList" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f;title=Source%20Code%20in%20Java%20--%20ArrayList" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Source%20Code%20in%20Java%20--%20ArrayList%20http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f&amp;t=Source%20Code%20in%20Java%20--%20ArrayList" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Source%20Code%20in%20Java%20--%20ArrayList&amp;url=http%3a%2f%2fkeltoy.github.io%2fposts%2fsource-code-in-java-arraylist%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
        </div>

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="http://keltoy.github.io/posts/source-code-in-java-spring-ioc/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Source Code in Java -- Spring IoC</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="http://keltoy.github.io/posts/spring-configuration-applicationcontext-service-xml-sqlmapconfig-xml/">
                    <span class="button__text">Spring Configuration-applicationContext-service.xml &amp; SqlMapConfig.xml</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js" integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>



    </body>
</html>
